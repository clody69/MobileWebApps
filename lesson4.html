<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]> <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]> <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]> ><! <![endif]-->
<html class='no-js' lang='en'>
<!-- <![endif] -->
<head>
<meta charset='utf-8' />
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible' />
<title>
Mobile Web Appplications Development with HTML5
|
Aalto University March 2011
</title>
<meta content='A course on developing mobile web applications with HTML5' name='description' />
<meta content='Claudio Riva' name='author' />
<meta content='width=1024, user-scalable=no' name='viewport' />
<!-- Coloring for code. To be included before the custom css like course and screen -->
<link href='css/coderay.css' rel='stylesheet' />
<!-- Core and extension CSS files -->
<link href='deckjs/core/deck.core.css' rel='stylesheet' />
<link href='deckjs/extensions/goto/deck.goto.css' rel='stylesheet' />
<link href='deckjs/extensions/menu/deck.menu.css' rel='stylesheet' />
<link href='deckjs/extensions/navigation/deck.navigation.css' rel='stylesheet' />
<link href='deckjs/extensions/status/deck.status.css' rel='stylesheet' />
<link href='deckjs/extensions/hash/deck.hash.css' rel='stylesheet' />
<!-- /%link(href="deckjs/extensions/scale/deck.scale.css" rel="stylesheet") -->
<!-- / %link(href="deckjs/extensions/notes/deck.notes.css" rel="stylesheet") -->
<!-- Theme CSS files (menu swaps these out) -->
<link href='css/course.css' id='style-theme-link' rel='stylesheet' />
<link href='deckjs/themes/transition/horizontal-slide.css' id='transition-theme-link' rel='stylesheet' />
<link href='css/screen.css' media='screen, projection' rel='stylesheet' type='text/css' />
<script src='js/jquery.min.js'></script>
<!-- Custom CSS just for this page -->
<script src='js/modernizr.custom.js'></script>
</head>
<body>
<div id='background'>
<div class='background front active' id='bg-default'></div>
<div class='background back' id='bg-default'></div>
</div>
<article class='deck-container'>
<section class='slide main-title'>
<h1>
Mobile Web Appplications Development with HTML5
</h1>
<img src='imgs/HTML5_logo.png' />
<br />
<h1 class='subtitle'>
Lecture 4: File & Device Access
</h1>
<br />
<div class='smaller centered'>
<h3>
Claudio Riva
</h3>
<h3>
Aalto University March 2011
</h3>
</div>
</section>

<section class='slide section-title'>
<h1>Lecture 4: Templating and MVC</h1>
<div class='agenda'>
<p>Bytes and Blobs</p>
<p>File API</p>
<p>HTML Media Capture API</p>
<p>Motion Sensor API</p>
<p>GeoLocation</p>
</div>
</section>
<section class='slide'>
<header>
Bytes and Blobs
<span class='smaller'>
(
<a href='https://developer.mozilla.org/en/DOM/Blob'>more info</a>
)
</span>
</header>
<article>
<ul>
<li>
<span class='terminal'>Blob</span>
= Binary Large Object
</li>
<li>A binary data interchange mechanism (File API)</li>
<li>Useful for moving data around</li>
<li>
Basic API for:
<ul>
<li>
<strong>size</strong>
: size in bytes of the blob
</li>
<li>
<strong>type</strong>
: MIME type of the data contained in the blob
</li>
<li>
<strong>slice(start, end, contentType)</strong>
: a new blob containing the data in the specified range of the source blob
</li>
</ul>
</li>
<li>Read only</li>
<li>May live on disk, so requires asynchronous access (e.g. FileReader)</li>
<li>
Created with the<span class='terminal'>
BlobBuilder
</span>interface or by slicing an exisitng blob
</li>
</ul>
</article>
</section>
<section class='slide'>
<header>
Why we need Blobs ?
</header>
<article>
<ul>
<li>File uploading from the client file system to the server</li>
<li>Downloading a file from web or filesystem and storing in localStorage</li>
<li>Injecting a file from the file system into the DOM</li>
<li>Decoding binary data (e.g. from websockets)</li>
<li>Audio Synthesis</li>
<li>Image processing</li>
</ul>
</article>
</section>
<section class='slide'>
<header>BlobBuilder</header>
<article>
<p>It provides the interface to construct a blob, append data and retrieve it:</p>
<ul>
<li>
<strong>append( ArrayBuffer | Blob | String)</strong>
: append chucks of data to the blob
</li>
<li>
<strong>getBlob( contentType )</strong>
: retrieves the blob with the desired MIME type.
</li>
</ul>
<div class="CodeRay">
  <div class="code"><pre><span class="keyword">var</span> BlobBuilder = window.MozBlobBuilder || window.WebKitBlobBuilder || window.BlobBuilder;&#x000A;b = <span class="keyword">new</span> BlobBuilder();&#x000A;b.append(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>);&#x000A;b.getBlob(<span class="string"><span class="delimiter">'</span><span class="content">text/plain</span><span class="delimiter">'</span></span>);&#x000A;              </pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>
File and Blobs
</header>
<article>
<p>
<span class='terminal'>File</span>
objects represent file data from the file system.
</p>
<p>
A
<span class='terminal'>File</span>
is a
<span class='terminal'>Blob</span>
(but a Blob is not a File) and in addition:
<ul>
<li>
<strong>name</strong>
</li>
<li>
<strong>lastModifiedDate</strong>
</li>
</ul>
</p>
<p>
<span class='terminal'>
FileReader
</span>
object provides the asynchronous read methods to access the files
</p>
</article>
</section>
<section class='slide'>
<header>
How to get a File
</header>
<article>
<ul>
<li>
With an input element of type file
<div class="CodeRay">
  <div class="code"><pre><span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span> <span class="attribute-name">multiple</span>=<span class="string"><span class="delimiter">'</span><span class="content">true</span><span class="delimiter">'</span></span> <span class="attribute-name">accept</span>=<span class="string"><span class="delimiter">'</span><span class="content">image/*</span><span class="delimiter">'</span></span><span class="tag">&gt;</span></pre></div>
</div>
</li>
<li>
With the drag-and-drop feature
</li>
<li>
User grants permission to read the files by selectig them
</li>
<li>
Read from a private filesystem sandbox
</li>
</ul>
</article>
</section>
<section class='slide'>
<header class='terminal'>
FileList
</header>
<article>
<p>
<span class='terminal'>FileList</span>
objects are an array-like sequence of
<span class='terminal'>File</span>
objects
</p>
<div class='vmargin'>
<div class="CodeRay">
  <div class="code"><pre><span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fileSelect</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">multiple</span>=<span class="string"><span class="delimiter">'</span><span class="content">true</span><span class="delimiter">'</span></span><span class="tag">&gt;</span></pre></div>
</div>
</div>
<div class='vmargin'>
<div class="CodeRay">
  <div class="code"><pre><span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#fileSelect</span><span class="delimiter">&quot;</span></span>).live(<span class="string"><span class="delimiter">'</span><span class="content">change</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(e) {&#x000A;  <span class="predefined">$</span>.each(<span class="local-variable">this</span>.files, <span class="keyword">function</span> (i,file){&#x000A;    console.log(file.name, file.size, file.type, file.lastModifiedDate);&#x000A;  }&#x000A;}</pre></div>
</div>
</div>
<p>
Test here:
<input id='fileSelect' multiple='true' type='file' />
</p>
</article>
</section>
<script type='text/javascript'>
  //<![CDATA[
    $(function () {
      $("#fileSelect").live('change', function(e) {
        $.each(this.files, function (i,file){
          console.log(file.name, file.size, file.type, file.lastModifiedDate);
        });
      });
    });
  //]]>
</script>
<section class='slide'>
<header>
XMLHttpRequest Level 2
</header>
<article>
<p>Old XMLHttpRequest was limited to send DomString or Document (XML) objects</p>
<p>
New XMLHttpRequest level 2 allows to send the following types:
<ul>
<li>DomString</li>
<li>Document (XML)</li>
<li>FormData</li>
<li>Blob</li>
<li>File</li>
<li>ArrayBuffer</li>
</ul>
</p>
</article>
</section>
<section class='slide'>
<header>
Sending a File
<span class='smaller'>
<a href='fileAPITests.html'>fileAPITests</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre><span class="predefined">$</span>.each(<span class="local-variable">this</span>.files, <span class="keyword">function</span> (i,file){&#x000A;  <span class="keyword">if</span> (!file.type.match(<span class="regexp"><span class="delimiter">/</span><span class="content">image.*</span><span class="delimiter">/</span></span>)) {&#x000A;    <span class="keyword">return</span>;&#x000A;  }  &#x000A;  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();&#x000A;  xhr.open(<span class="string"><span class="delimiter">'</span><span class="content">POST</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">/uploadFile</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);&#x000A;  xhr.<span class="function">onload</span> = <span class="keyword">function</span>(e) {console.log (<span class="local-variable">this</span>.responseText); };&#x000A;  xhr.setRequestHeader(<span class="string"><span class="delimiter">&quot;</span><span class="content">X-File-Name</span><span class="delimiter">&quot;</span></span>, file. name);&#x000A;  xhr.setRequestHeader(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/octet-stream</span><span class="delimiter">&quot;</span></span>);&#x000A;  xhr.send(file); <span class="comment">//XHR2</span>&#x000A;});&#x000A;</pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>
FormData
</header>
<article>
<p><span class='terminal'>
FormData
</span>objects provide a way to easily build a set of key/value pairs (like Forms).
</p>
<p>
The objects can be sent to the server with the XHR2
<span class='terminal'>send</span>
method as a
<span class='terminal'>multipart/form-data</span>
</p>
<p>
The interface allows to<span class='terminal'>
append
</span>a key/value pair where:
<ul>
<li>
<strong>name</strong>
is the a string representing the key
</li>
<li>
<strong>value</strong>
is the value of the field: Blob, File or string
</li>
</ul>
</p>
</article>
</section>
<section class='slide'>
<header>
Sending files with FormData
<span class='smaller'>
<a href='fileAPITests.html'>fileAPITests</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre><span class="keyword">var</span> fd = <span class="keyword">new</span> FormData(); <span class="comment">// XHR2        </span>&#x000A;<span class="predefined">$</span>.each(<span class="local-variable">this</span>.files, <span class="keyword">function</span> (i,file){&#x000A;  fd.append(file.name, file);&#x000A;});&#x000A;&#x000A;<span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest(); &#x000A;xhr.open(<span class="string"><span class="delimiter">'</span><span class="content">POST</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">/uploadFormData</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);&#x000A;xhr.<span class="function">onload</span> = <span class="keyword">function</span>(e) {console.log (<span class="local-variable">this</span>.responseText); };&#x000A;&#x000A;xhr.send(fd); <span class="comment">// as multipart/form-data</span>&#x000A;</pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>
Downloading a Blob
</header>
<article>
<p>
XHR2 allows to specify the type of the response:
<ul>
<li>
<strong>xhr.responseType</strong>
:
<span class='terminal'>
text | arraybuffer | blob | document
</span>
</li>
<li>
<strong>xhr.response</strong>
: the requested data
</li>
</ul>
</p>
</article>
</section>
<section class='slide'>
<header>
What can we do with a Blob ?
</header>
<article>
<p>
Create an object and insert it in the DOM
<ul>
<li>
<div class='terminal'>URL.createObjectURL()</div>
</li>
<li>
<div class='terminal'>URL.revokeObjectutL()</div>
</li>
</ul>
</p>
<p>
Read the content with a FileReader:
<ul class='terminal'>
<li>FileReader.readAsText( File|Blob )</li>
<li>FileReader.readAsBinaryString( File|Blob )</li>
<li>FileReader.readAsArrayBuffer( File|Blob )</li>
<li>FileReader.readAsDataURL( File|Blob )</li>
</ul>
</p>
<p>
Messages to/form WebWorkers
</p>
<p>Store in localStorage or IndexedDB</p>
</article>
</section>
<section class='slide'>
<header>
Downloading a Blob
<span class='smaller'>
<a href='fileAPITests.html'>fileAPITests</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();&#x000A;xhr.open(<span class="string"><span class="delimiter">'</span><span class="content">GET</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">logo.png</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);&#x000A;xhr.responseType = <span class="string"><span class="delimiter">'</span><span class="content">blob</span><span class="delimiter">'</span></span>;&#x000A;&#x000A;xhr.<span class="function">onload</span> = <span class="keyword">function</span>(e) {&#x000A;  <span class="keyword">if</span> (<span class="local-variable">this</span>.status == <span class="integer">200</span>) {&#x000A;    <span class="keyword">var</span> blob = <span class="local-variable">this</span>.response;&#x000A;    &#x000A;    <span class="keyword">var</span> img = document.createElement(<span class="string"><span class="delimiter">'</span><span class="content">img</span><span class="delimiter">'</span></span>);&#x000A;    img.<span class="function">onload</span> = <span class="keyword">function</span>(e) {&#x000A;      window.URL.revokeObjectURL(img.src); <span class="comment">// Clean up after yourself.</span>&#x000A;    };&#x000A;    img.src = window.URL.createObjectURL(blob);&#x000A;    <span class="predefined">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#blobOutput</span><span class="delimiter">'</span></span>).append(img);&#x000A;  }&#x000A;};&#x000A;xhr.send();  &#x000A;</pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>ArrayBuffer</header>
<article>
<p>
<span class='terminal'>ArrayBuffer</span>
is a generic container for binary data.
</p>
<p>
With typed arrays we can create different views from a single
<span class='terminal'>ArrayBuffer</span>
:
<div class='row'>
<div class='twoColumn'>
<ul>
<li>DataView</li>
<li>Float32Array</li>
<li>Float64Array</li>
<li>Int16Array</li>
<li>Int32Array</li>
<li>Int8Array</li>
</ul>
</div>
<div class='twoColumn'>
<ul>
<li>Uint16Array</li>
<li>Uint32Array</li>
<li>Uint8Array</li>
</ul>
</div>
</div>
</p>
</article>
</section>
<section class='slide'>
<header>
Downloading to an Array
<span class='smaller'>
<a href='fileAPITests.html'>fileAPITests</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();&#x000A;xhr.open(<span class="string"><span class="delimiter">'</span><span class="content">GET</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">logo.png</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);&#x000A;xhr.responseType = <span class="string"><span class="delimiter">'</span><span class="content">arraybuffer</span><span class="delimiter">'</span></span>;&#x000A;&#x000A;xhr.<span class="function">onload</span> = <span class="keyword">function</span>(e) {&#x000A;  <span class="keyword">if</span> (<span class="local-variable">this</span>.status == <span class="integer">200</span>) {&#x000A;    <span class="keyword">var</span> a = <span class="keyword">new</span> Uint8Array(<span class="local-variable">this</span>.response);&#x000A;    html = <span class="string"><span class="delimiter">'</span><span class="content">First 3 bytes: </span><span class="delimiter">'</span></span> + a[<span class="integer">0</span>] + <span class="string"><span class="delimiter">'</span><span class="content">,</span><span class="delimiter">'</span></span> + a[<span class="integer">1</span>] + <span class="string"><span class="delimiter">'</span><span class="content">,</span><span class="delimiter">'</span></span> + a[<span class="integer">2</span>];  &#x000A;    <span class="predefined">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#arrayOutput</span><span class="delimiter">'</span></span>).html(html);&#x000A;  }&#x000A;};&#x000A;xhr.send();  &#x000A;</pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>What can I do with an ArrayBuffer?</header>
<article>
<ul>
<li>Interface with Audio API</li>
<li>WebGL</li>
<li>WebSockets</li>
</ul>
</article>
</section>
<section class='slide'>
<header class='terminal'>FileReader</header>
<article>
<span class='terminal'>FileReader</span>
is an object that enables asynchronous reading of
<span class='terminal'>File</span>
and
<span class='terminal'>Blob</span>
objects.
The following read methods are available:
<ul>
<li>
<strong>readAsText</strong>
: the result is a text string with default UTF-8
</li>
<li>
<strong>readAsArrayBuffer</strong>
: the result is stored in a ArrayBuffer object
</li>
<li>
<strong>readAsBinaryString</strong>
: the result is a binary string where each byte is an integer in the range [0-255]
</li>
<li>
<strong>readAsDataURL</strong>
: the result is stored in a DataURL object using the
<a href='http://en.wikipedia.org/wiki/Data_URI_scheme'>data URI scheme</a>
(e.g.
<span class='terminal'>data:image/png;base64,iVBO...</span>
)
</li>
</ul>
<p>For tracking the progress, the following callbacks are available: onloadstart, onprogress, onload, onabort, onerror, and onloadend.</p>
</article>
</section>
<section class='slide'>
<header>
<span class='terminal'>FileReader.readAsText()</span>
<span class='smaller'>
<a href='fileAPITests.html'>fileAPITests</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre><span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();&#x000A;reader.<span class="function">onload</span> = <span class="keyword">function</span>() {&#x000A;  <span class="keyword">var</span> text = reader.result;&#x000A;  <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#fileTextOutput</span><span class="delimiter">&quot;</span></span>).html(text);&#x000A;}&#x000A;reader.readAsText(<span class="local-variable">this</span>.files[<span class="integer">0</span>]);         &#x000A;</pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>
<span class='terminal'>FileReader.readAsDataURL()</span>
<span class='smaller'>
<a href='fileAPITests.html'>fileAPITests</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre><span class="keyword">var</span> reader = <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();&#x000A;    reader.<span class="function">onload</span> = <span class="keyword">function</span>() {&#x000A;      <span class="keyword">var</span> text = <span class="string"><span class="delimiter">'</span><span class="content">&lt;img src=&quot;</span><span class="delimiter">'</span></span>+reader.result+<span class="string"><span class="delimiter">'</span><span class="content">&quot;/&gt;</span><span class="delimiter">'</span></span>;&#x000A;      <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#fileDataURLOutput</span><span class="delimiter">&quot;</span></span>).html(text);&#x000A;    }&#x000A;    reader.readAsDataURL(<span class="local-variable">this</span>.files[<span class="integer">0</span>]);         &#x000A;</pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>What works on mobile ?</header>
<article>
<div class='image-wrap'><img src='imgs/lesson4/file-api-browsers.png' class='resize' /></div>
<div class='autobox smaller'>
<ul>
<li>
HTML5 Specs:
<a href='http://dev.w3.org/2006/webapi/FileAPI'>File API</a>
,
<a href='http://www.w3.org/TR/XMLHttpRequest/'>XHR2</a>
,
<a href='Typed Arrays'>Native binary Array</a>
</li>
<li>
Opera:
<a href='http://www.opera.com/docs/specs/presto2.10/file/'>Opera Mobile File API</a>
</li>
<li>
Firefox:
<a href='https://developer.mozilla.org/en/DOM/XMLHttpRequest/Using_XMLHttpRequest'>FireFox XHR2</a>
,
<a href='https://developer.mozilla.org/en/JavaScript_typed_arrays'>FireFox Typed Arrays</a>
,
<a href='https://developer.mozilla.org/en/DOM/FileReader'>FileReader</a>
</li>
<li>
Html5Rocks Tricks:
<a href='http://www.html5rocks.com/en/tutorials/file/xhr2/'>XHR2</a>
,
<a href='http://www.html5rocks.com/en/tutorials/file/dndfiles/'>Local files</a>
</li>
</ul>
</div>
</article>
</section>
<section class='slide'>
<header>
Good old
<span class='terminal'>
multipart/form-data
</span>
</header>
<article>
<p>Content type for submitting forms that contain binary data</p>
<p>Works with all browsers</p>
<div class='vmargin'>
<div class="CodeRay">
  <div class="code"><pre><span class="tag">%form</span>(<span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uploadFormPost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/uploadFormData</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">method</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">data-ajax</span>=<span class="string"><span class="delimiter">'</span><span class="content">false</span><span class="delimiter">'</span></span> <span class="attribute-name">enctype</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)&#x000A;  <span class="tag">%input</span>(<span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">file</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fileChoose0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">file</span><span class="delimiter">&quot;</span></span>  <span class="attribute-name">multiple</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">accept</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">image/*</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">height:0;width:0;</span><span class="delimiter">&quot;</span></span>) &#x000A;  <span class="tag">%button</span>(<span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">uploadFormPostButton</span><span class="delimiter">&quot;</span></span>) Upload via Form POST </pre></div>
</div>
</div>
<div class='vmargin'>
<div class="CodeRay">
  <div class="code"><pre><span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#uploadFormPostButton</span><span class="delimiter">&quot;</span></span>).click(<span class="keyword">function</span>(e) { &#x000A;  e.preventDefault();&#x000A;  <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#fileChoose0</span><span class="delimiter">&quot;</span></span>).click();&#x000A;});&#x000A;<span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#fileChoose0</span><span class="delimiter">&quot;</span></span>).live(<span class="string"><span class="delimiter">'</span><span class="content">change</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>() {&#x000A;  <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#uploadFormPost</span><span class="delimiter">&quot;</span></span>).submit();&#x000A;});&#x000A;</pre></div>
</div>
</div>
</article>
</section>
<section class='slide'>
<header>
<img src = 'imgs/html5/HTML5_Device_Access_64.png'>HTML Media Capture API</img>
</header>
<article></article>
</section>
<section class='slide'>
<header>
<img src = 'imgs/html5/HTML5_Device_Access_64.png'>Device Orientation API</img>
</header>
<article>
<p>API to access the information of accelererometers, gyroscopes and compasses of mobile devices</p>
<div class='autobox'>
<div class='row'>
<div class='twoColumn'>
<div class='autobox'>
<strong>DeviceOrientation Event</strong>
<ul>
<li>alpha: around the Z-axis</li>
<li>beta: around the X-axis</li>
<li>gamma: around the Y-axis</li>
</ul>
<strong>MotionOrientation Event</strong>
<ul>
<li>acceleration</li>
<li>accelerationIncludingGravity</li>
</ul>
</div>
</div>
<div class='twoColumn'>
<div class='image-wrap'><img src='imgs//lesson4/orientation.png' class='resize' /></div>
</div>
</div>
</div>
</article>
</section>
<section class='slide'>
<header>
<img src = 'imgs/html5/HTML5_Device_Access_64.png'>Device Orientation API</img>
</header>
<article>
<div class='row'>
<div class='threeColumn'>
<div class='autobox centered'>
Heading (Yaw)
<div class='image-wrap'><img src='imgs//lesson4/orientation-alpha.png' class='resize' /></div>
</div>
</div>
<div class='threeColumn'>
<div class='autobox centered'>
Elevation (Pitch)
<div class='image-wrap'><img src='imgs//lesson4/orientation-beta.png' class='resize' /></div>
</div>
</div>
<div class='threeColumn'>
<div class='autobox centered'>
Bank (Roll)
<div class='image-wrap'><img src='imgs//lesson4/orientation-gamma.png' class='resize' /></div>
</div>
</div>
</div>
</article>
</section>
<section class='slide'>
<header>
Orientation Events
<span class='smaller'>
<a href='sensorOrientation.html'>sensorOrientation</a>
</span>
</header>
<article>
<div class="CodeRay">
  <div class="code"><pre>    <span class="predefined">$</span>(<span class="keyword">function</span>() {&#x000A;    <span class="keyword">if</span> (window.DeviceOrientationEvent) {  &#x000A;      window.addEventListener(<span class="string"><span class="delimiter">&quot;</span><span class="content">deviceorientation</span><span class="delimiter">&quot;</span></span>, <span class="keyword">function</span>( event ) {  &#x000A;        }&#x000A;        <span class="comment">//alpha: rotation around z-axis  </span>&#x000A;        <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">.alpha</span><span class="delimiter">&quot;</span></span>).html(event.alpha);&#x000A;&#x000A;        <span class="comment">//gamma: left to right  </span>&#x000A;        <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">.beta</span><span class="delimiter">&quot;</span></span>).html(event.beta);&#x000A;&#x000A;        <span class="comment">//beta: front back motion  </span>&#x000A;        <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">.gamma</span><span class="delimiter">&quot;</span></span>).html(event.gamma);&#x000A;        &#x000A;        <span class="keyword">var</span> rotation = <span class="string"><span class="delimiter">&quot;</span><span class="content">rotateX(</span><span class="delimiter">&quot;</span></span>+(event.beta*-<span class="integer">1</span>)+<span class="string"><span class="delimiter">&quot;</span><span class="content">deg)</span><span class="delimiter">&quot;</span></span>&#x000A;        rotation += <span class="string"><span class="delimiter">&quot;</span><span class="content"> rotateY(</span><span class="delimiter">&quot;</span></span>+(event.gamma)+<span class="string"><span class="delimiter">&quot;</span><span class="content">deg)</span><span class="delimiter">&quot;</span></span> &#x000A;        rotation += <span class="string"><span class="delimiter">&quot;</span><span class="content">rotateZ(</span><span class="delimiter">&quot;</span></span>+(event.alpha*-<span class="integer">1</span>)+<span class="string"><span class="delimiter">&quot;</span><span class="content">deg)</span><span class="delimiter">&quot;</span></span>;&#x000A;&#x000A;        <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">.transform</span><span class="delimiter">&quot;</span></span>).html(rotation);&#x000A;        <span class="predefined">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#imgLogo</span><span class="delimiter">&quot;</span></span>).css(<span class="string"><span class="delimiter">'</span><span class="content">-moz-transform</span><span class="delimiter">'</span></span>,rotation);&#x000A;      }, <span class="predefined-constant">false</span>);  &#x000A;    }  &#x000A;  }&#x000A;  </pre></div>
</div>
</article>
</section>
<section class='slide'>
<header>Camera API</header>
<article>
http://www.w3.org/TR/2010/WD-html-media-capture-20100720/
http://my.opera.com/core/blog/2011/03/23/webcam-orientation-preview
</article>
</section>
<section class='slide'>
<header>
Resources
</header>
<article>
http://davidflanagan.com/Talks/jsconf11/BytesAndBlobs.html
</article>
</section>

<!-- Elements -->
<a class='deck-next-link' href='#' title='Next'>â†’</a>
<a class='deck-prev-link' href='#' title='Previous'>&#8592;</a>
<p class='deck-status'>
<span class='deck-status-current'></span>
/
<span class='deck-status-total'></span>
</p>
<a class='deck-permalink' href='.' title='Permalink to this slide'>#</a>
<script src='deckjs/core/deck.core.js'></script>
<script src='deckjs/extensions/menu/deck.menu.js'></script>
<script src='deckjs/extensions/goto/deck.goto.js'></script>
<script src='deckjs/extensions/status/deck.status.js'></script>
<script src='deckjs/extensions/navigation/deck.navigation.js'></script>
<script src='deckjs/extensions/hash/deck.hash.js'></script>
<!-- /%script(src="deckjs/extensions/scale/deck.scale.js") -->
<!-- /%script(src="deckjs/extensions/notes/deck.notes.js") -->
<script src='js/main.js'></script>
<script type='text/javascript'>
  //<![CDATA[
    $(document).bind('deck.change', function(event, from, to) {
     
      //alert('Moving from slide ' + from + ' to ' + to);
      var f = $.deck('getSlide', from).closest('section').attr("data-background");
      var t = $.deck('getSlide', to).closest('section').attr("data-background");
      if (t==undefined) { t = "bg-default"; }
      if (f==undefined) { f = "bg-default"; }
             
      
      var front = $('#background > .front').first();
      var back = $('#background > .back').first();
    
      if (front.hasClass('active')) {
        if (front.attr('id') == t) { return; }
    
        back.attr('id',t);
        front.removeClass('active');
        back.addClass('active');
        front.css('opacity',0);
      } else {
        if (back.attr('id') == t) { return; }
    
        front.attr('id',t);
        back.removeClass('active');
        front.addClass('active');
        front.css('opacity',1);
      }
      
      //last.attr('id',active.attr('id'));
      //last.css('opacity',1);
      //active.remove();
      //$("#background").append('<div class="background active" id="'+t+'" style="opacity: 0; "></div>')
      //$("#"+t).css('opacity',1);
      //var el = $("#"+t);
    
      //active.removeClass('active').addClass('last');
      //last.removeClass('last').addClass('active');
      
      //last.dequeue();
      //active.dequeue();
             
      //active.css('opacity',0);
      //alert(last.attr('id'));
      //active.fadeOut('slow');
      //last.fadeIn('slow', function() {
      //});
      
      //last.fadeIn('slow');
      //$("#"+t).css('opacity',1);
      //last.css('opacity',1);
      //el = $("#"+t);
      //el.animate({opacity: 1.0}, 1000);
    
      //if (t==undefined && f == undefined) {
      //} else if (t == f) {
      //}
      //else if (t != undefined) {
      //  $('#background').css("background-image", "url(" + t + ")").fadeIn('slow');
      //} else if (t == undefined) {
      //  $('#background').fadeOut('slow');
      //}
    });
      //current = $('body').css("background-image");
      //alert(current);
  //]]>
</script>
<!-- .slide-footer -->
<!-- =META['title'] -->
<!-- \- -->
<!-- =META['author'] -->
</article>
</body>
</html>
